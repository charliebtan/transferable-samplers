# @package _global_

defaults:
  - override /model: normalizing_flow
  - override /data: single_system/al6
  - override /trainer: gpu

ckpt_path: null
train: False
val: False
test: True
task_name: eval

model:
  sampling_config:
    use_com_adjustment: True
    batch_size: 10_000
    num_test_proposal_samples: 10_000
    num_smc_samples: 1_000_000 
    clip_reweighting_logits: 0.002
  net:
    _target_: src.models.neural_networks.tarflow.tarflow.TarFlow
    in_channels: 3
    channels: 384
    num_blocks: 6
    layers_per_block: 6
    dropout: 0.0

  smc_sampler:
    _target_: src.models.samplers.continuous_time_smc_sampler.ContinuousTimeSMCSampler
    enabled: True
    langevin_eps: 1e-7
    num_timesteps: 100
    ess_threshold: 1.0
    systematic_resampling: True
    warmup: 0.
    batch_size: 256 # set for 48gb
    input_energy_cutoff: 100 #Â this might need tuning if you get NaNs!
    do_energy_plots: True
    log_freq: 1
    
data:
  batch_size: 10_000
  com_augmentation: True
  num_eval_samples: 10_000

trainer:
  limit_test_batches: 1
  limit_val_batches: 1